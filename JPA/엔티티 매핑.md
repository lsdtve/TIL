# 객체와 테이블 매핑

### @Entity

- `@Entity`가 붙은 클래스는 JPA가 관리, 엔티티라 한다. 

- `JPA`를 사용해서 테이블과 매핑할 클래스는 `@Entity` 필수

  **[주의]**

  - 기본 생성자 필수 ( 파라미터가 없는 public 또는  protected 생성자 )
  - final 클래스, enum, interface, inner클래스 사용 X
  - 저장할 필드에 final 사용 X

| 속성 | 기능                                                         | 기본값                                    |
| ---- | ------------------------------------------------------------ | ----------------------------------------- |
| name | JPA에서 사용할 엔티티 이름을 지정한다. 보통 기본값인 클래스 이름을 사용한다. 만약 다른 패키지에 이름이 같은 엔티티 클래스가 있다면 이름을 지정해서 충돌하지 않도록 해야 한다. | 설정하지 않으면 클래스 이름을 그대로 사용 |



### @Table

- `@Table`은 엔티티와 매핑할 테이블 지정

| 속성                    | 기능                                                         | 기본값             |
| ----------------------- | ------------------------------------------------------------ | ------------------ |
| name                    | 매핑할 테이블 이름                                           | 엔티티 이름을 사용 |
| catalog                 | catalog 기능이 있는 데이터베이스에서 catalog를 매핑한다      |                    |
| schema                  | schema 기능이 있는 데이터베이스에서 schema를 매핑한다        |                    |
| uniqueConstraints (DDL) | DDL 생성 시에 유니크 제약조건을 만든다. 2개 이상의 복합 유니크 제약조건도 만들 수 있다. 참고로 이 기능은 스키마 자동 생성 기능을 사용해서 DDL을 만들 때만 사용된다. |                    |


# DB 스미카 자동 생성

- DDL을 애플리케이션 실행 시점에 자동 생성

- 테이블 중심 -> 객체 중심

- 데이터베이스 방언을 활용해서 데이터베이스에 맞는 적절한 DDL 생성


```java  
<property name="hibernate.hbm2ddl.auto" value="create"/>
```

| 옵션        | 설명                                                         |
| ----------- | ------------------------------------------------------------ |
| create      | 기존 테이블을 삭제하고 새로 생성한다. **DROP + CREATE**      |
| create-drop | create 속성에 추가로 애플리케이션을 종료할 때 생성한 DDL을 제거한다. **DROP + CREATE + DROP** |
| update      | 데이터베이스 테이블과 엔티티 매핑정보를 비교해서 변경 사항만 수정한다. |
| validate    | 데이터베이스 테이블과 엔티티 매핑정보를 비교해서 차이가 있으면 경고를 남기고 애플리케이션을 실행하지 않는다. 이 설정은 **DDL을 수정하지 않는다.** |
| none        | 자동 생성 기능을 사용하지 않으려면 hibernate.hbm2ddl.auto 속성 자체를 삭제하거나 유효하지 않은 옵션 값을 주면 된다(참고로 none은 유효하지 않은 옵션 값) |



# 필드와 컬럼 매핑



### @Column (컬럼 매핑)

| 속성                                                         | 기능                                                         | 기본값                                                       |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| name                                                         | 필드와 매핑할 데이틀의 컬럼 이름                             |                                                              |
| insertable                                                   | 엔티티 저장 시 이 필드도 같이 저장한다. false로 설정하면 이 필드는 데이터베이스에 저장하지 않는다. false 옵션은 읽기 전용일 때 사용한다. | true                                                         |
| updatable                                                    | 엔티티 수정 시 이 필드도 같이 수정한다. false로 설정하면 데이터베이스에 수정하지 않는다. false 옵션은 읽기 전용일 때 사용한다. | true                                                         |
| table                                                        | 하나의 엔티티를 두 개 이상의 테이블에 매핑할 때 사용한다. 지정한 필드를 다른 테이블에 매핑할 수 있다. | 현재 클래스가 매핑된 테이블                                  |
| nullable(DDL)                                                | null 값의 허용 여부를 설정한다. false로 설정하면 DDL 생성 시에 not null 제약조건이 붙는다 | true                                                         |
| unique(DDL)                                                  | @Table의 uniqueConstraints와 같지만 한 컬럼에 간단히 유니크 제약조건을 걸 때 사용한다. 만약 두 컬럼 이상을 사용해서 유니크 제약조건을 사용하려면 클래스 레벨에서 @Table.uniqueConstraints를 사용해야 한다. |                                                              |
| ㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤcolumnDefinition(DDL)ㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤ | 데이터베이스 컬럼 정보를 직접 줄 수 있다.                    | 필드의 자바 타입과 방언 정보를 사용해서 적절한 컬럼 타입을 생성한다. |
| length(DDL)                                                  | 문자 길이 제약조건, String 타입에만 사용한다.                | 255                                                          |
| precision, scale(DDL)                                        | BigDecimal 타입에서 사용한다(BigInteger도 사용할 수 있다). precision은 소수점을 포함한 전체 자릿수를, scale은 소수의 자릿수다. 참고로 double, float 타입에는 적용되지 않는다. 아주 큰 숫자나 정밀한 소수를 다루어야 할 때만 사용한다. | precision=19, scale=2                                        |



### @Enumerated

- Java enum 타입을 매필할 때 사용

| 속성  | 기능                                                         | 기본값           |
| ----- | ------------------------------------------------------------ | ---------------- |
| value | **EnumType.ORDINAL**: enum 순서를 데이터베이스에 저장,  <br>**EnumType.STRING**: enum 이름을 데이터베이스에 저장 | EnumType.ORDINAL |



### @Temporal

- 날짜 타입 (java.util.Date, java.util.Calendar)을 매핑할 때 사용

| 속성  | 기능                                                         | 기본값          |
| ----- | ------------------------------------------------------------ | --------------- |
| value | **TemporalType.DATE**: 날짜, 데이터베이스 date 타입과 매핑<br>**TemporalType.TIME**: 시간, 데이터베이스 time 타입과 매핑**<br>TemporalType.TIMESTAMP**: 날짜와 시간, 데이터베이스 timestamp 타입과 매핑 | EnumType.ORDINA |



### @Lob

- 데이터베이스 BLOB, CLOB 타입과 매핑합니다.

- `@LOB`에는 지정할 수 있는 속성이 없습니다.
- 대신에 매핑하는 필드 타입이 문자면 `CLOB`으로 매핑하고 나머지는 `BLOB`으로 매핑합니다.
  - `CLOB`: String, char[], java.sql.CLOB
  - `BLOB`: byte[], java.sql.BLOB



### @Transient

- 필드 매핑 X
- 데이터베이스에 저장X, 조회X
- 주로 메모리상에서만 임시로 어떤 값을 보관하고 싶을 때 사용

